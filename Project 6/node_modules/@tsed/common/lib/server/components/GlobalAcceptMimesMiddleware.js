"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const ts_httpexceptions_1 = require("ts-httpexceptions");
const config_1 = require("../../config");
const filters_1 = require("../../filters");
const mvc_1 = require("../../mvc");
/**
 * @middleware
 */
let GlobalAcceptMimesMiddleware = class GlobalAcceptMimesMiddleware {
    constructor(serverSettingsService) {
        this.serverSettingsService = serverSettingsService;
    }
    use(request) {
        const find = this.serverSettingsService.acceptMimes.find((mime) => !!request.accepts(mime));
        if (!find) {
            throw new ts_httpexceptions_1.NotAcceptable(this.serverSettingsService.acceptMimes.join(", "));
        }
    }
};
tslib_1.__decorate([
    tslib_1.__param(0, filters_1.Req()),
    tslib_1.__metadata("design:type", Function),
    tslib_1.__metadata("design:paramtypes", [Object]),
    tslib_1.__metadata("design:returntype", void 0)
], GlobalAcceptMimesMiddleware.prototype, "use", null);
GlobalAcceptMimesMiddleware = tslib_1.__decorate([
    mvc_1.Middleware(),
    tslib_1.__metadata("design:paramtypes", [config_1.ServerSettingsService])
], GlobalAcceptMimesMiddleware);
exports.GlobalAcceptMimesMiddleware = GlobalAcceptMimesMiddleware;

//# sourceMappingURL=GlobalAcceptMimesMiddleware.js.map
