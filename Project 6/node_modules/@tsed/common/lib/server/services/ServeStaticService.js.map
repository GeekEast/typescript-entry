{"version":3,"sources":["server/services/ServeStaticService.ts"],"names":[],"mappings":";;;AAAA,iCAAiC;AACjC,mCAAmC;AACnC,yCAAmD;AACnD,yEAAoE;AAGpE,IAAa,kBAAkB,GAA/B,MAAa,kBAAkB;IAC7B,YAAwC,UAA+B,EAAU,qBAA4C;QAArF,eAAU,GAAV,UAAU,CAAqB;QAAU,0BAAqB,GAArB,qBAAqB,CAAuB;IAAG,CAAC;IAEjI,gBAAgB;QACd,MAAM,OAAO,GAAG,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC;QACnD,0BAA0B;QAC1B,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YAClC,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,SAAiB,EAAE,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC;QAC9F,CAAC,CAAC,CAAC;IACL,CAAC;IAED,KAAK,CAAC,IAAY,EAAE,SAAiB;QACnC,MAAM,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAC7C,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,OAAY,EAAE,QAAa,EAAE,IAAS,EAAE,EAAE;YACnE,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE;gBACzB,UAAU,CAAC,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;aACrC;iBAAM;gBACL,IAAI,EAAE,CAAC;aACR;QACH,CAAC,CAAC,CAAC;IACL,CAAC;CACF,CAAA;AArBY,kBAAkB;IAD9B,YAAO,EAAE;IAEK,mBAAA,uCAAkB,CAAA;uDAAyE,8BAAqB;GADlH,kBAAkB,CAqB9B;AArBY,gDAAkB","file":"ServeStaticService.js","sourcesContent":["import {Service} from \"@tsed/di\";\nimport * as Express from \"express\";\nimport {ServerSettingsService} from \"../../config\";\nimport {ExpressApplication} from \"../decorators/expressApplication\";\n\n@Service()\nexport class ServeStaticService {\n  constructor(@ExpressApplication private expressApp: Express.Application, private serverSettingsService: ServerSettingsService) {}\n\n  $afterRoutesInit() {\n    const statics = this.serverSettingsService.statics;\n    /* istanbul ignore else */\n    Object.keys(statics).forEach(path => {\n      [].concat(statics[path] as any).forEach((directory: string) => this.mount(path, directory));\n    });\n  }\n\n  mount(path: string, directory: string) {\n    const middleware = Express.static(directory);\n    this.expressApp.use(path, (request: any, response: any, next: any) => {\n      if (!response.headersSent) {\n        middleware(request, response, next);\n      } else {\n        next();\n      }\n    });\n  }\n}\n"],"sourceRoot":"../../../src"}