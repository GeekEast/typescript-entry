{"version":3,"sources":["server/services/ServeStaticService.ts"],"names":[],"mappings":"AACA,OAAO,KAAK,OAAO,MAAM,SAAS,CAAC;AACnC,OAAO,EAAC,qBAAqB,EAAC,MAAM,cAAc,CAAC;AAGnD,qBACa,kBAAkB;IACG,OAAO,CAAC,UAAU;IAAuB,OAAO,CAAC,qBAAqB;gBAA9D,UAAU,EAAE,OAAO,CAAC,WAAW,EAAU,qBAAqB,EAAE,qBAAqB;IAE7H,gBAAgB;IAQhB,KAAK,CAAC,IAAI,EAAE,MAAM,EAAE,SAAS,EAAE,MAAM;CAUtC","file":"ServeStaticService.d.ts","sourcesContent":["import {Service} from \"@tsed/di\";\nimport * as Express from \"express\";\nimport {ServerSettingsService} from \"../../config\";\nimport {ExpressApplication} from \"../decorators/expressApplication\";\n\n@Service()\nexport class ServeStaticService {\n  constructor(@ExpressApplication private expressApp: Express.Application, private serverSettingsService: ServerSettingsService) {}\n\n  $afterRoutesInit() {\n    const statics = this.serverSettingsService.statics;\n    /* istanbul ignore else */\n    Object.keys(statics).forEach(path => {\n      [].concat(statics[path] as any).forEach((directory: string) => this.mount(path, directory));\n    });\n  }\n\n  mount(path: string, directory: string) {\n    const middleware = Express.static(directory);\n    this.expressApp.use(path, (request: any, response: any, next: any) => {\n      if (!response.headersSent) {\n        middleware(request, response, next);\n      } else {\n        next();\n      }\n    });\n  }\n}\n"],"sourceRoot":"../../../src"}