"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
var AuthenticatedMiddleware_1;
const ts_httpexceptions_1 = require("ts-httpexceptions");
const filters_1 = require("../../filters");
const middleware_1 = require("../decorators/class/middleware");
/**
 * This middleware manage the authentication based on passport strategy.
 *
 * @middleware
 */
let AuthenticatedMiddleware = AuthenticatedMiddleware_1 = class AuthenticatedMiddleware {
    use(request, endpoint) {
        const options = endpoint.get(AuthenticatedMiddleware_1) || {};
        // @ts-ignore
        if (request.isAuthenticated && !request.isAuthenticated(options)) {
            throw new ts_httpexceptions_1.Unauthorized("Unauthorized");
        }
    }
};
tslib_1.__decorate([
    tslib_1.__param(0, filters_1.Req()), tslib_1.__param(1, filters_1.EndpointInfo()),
    tslib_1.__metadata("design:type", Function),
    tslib_1.__metadata("design:paramtypes", [Object, Object]),
    tslib_1.__metadata("design:returntype", void 0)
], AuthenticatedMiddleware.prototype, "use", null);
AuthenticatedMiddleware = AuthenticatedMiddleware_1 = tslib_1.__decorate([
    middleware_1.Middleware()
], AuthenticatedMiddleware);
exports.AuthenticatedMiddleware = AuthenticatedMiddleware;

//# sourceMappingURL=AuthenticatedMiddleware.js.map
